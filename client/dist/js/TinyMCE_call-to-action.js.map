{"version":3,"sources":["webpack:///webpack/bootstrap e9e7175a25db2d41abfa","webpack:///./client/src/legacy/entwine/TinyMCE_call-to-action.js","webpack:///external \"jQuery\"","webpack:///external \"React\"","webpack:///external \"ShortcodeSerialiser\"","webpack:///external \"i18n\""],"names":["commandName","plugin","init","editor","addButton","text","i18n","_t","tooltip","icon","class","cmd","addCommand","id","entwine","openCallToActionDialog","addContextToolbar","embed","dom","is","beforeSetContent","onSetContent","onPreProcess","handleRemoveCallToActionClick","on","e","placeholderClasses","getPlaceholderClasses","content","forEach","code","match","counter","ShortcodeSerialiser","params","url","encodeURI","$","ajax","type","data","JSON","stringify","contentType","async","success","html","attr","name","wrapped","properties","replaceAll","original","prop","node","each","idx","elm","$elm","removeAttr","shortcode","serialise","replaceWith","unprocessed","undoManager","transact","contentEditable","jQuery","onchange","parents","reloadForm","val","Bookmark","onadd","ssdialog","autoOpen","_super","getForm","find","open","close","toggle","bool","classes","split","self","dialog","bookmark","selection","getBookmark","length","setElement","setBookmark","append","complete","removeClass","trigger","Selection","Element","setSelection","onremove","from","postdata","CallToActionType","Shortcode","addClass","post","form","show","onsubmit","insertShortcode","getDialog","getHTML","modifySelection","ed","getInstance","calltoaction","tinyMCE","activeEditor","plugins","replaceContent","callback","getEditor","moveToBookmark","call","getSelectedNode","createBookmark","blur","getElement","closest","getAttributes","shortcodeType","key","attributes","serializeArray","attributesComposite","attributeField","attributeVal","attributeName","indexOf","substring","resetFields","hide","updateFromEditor","getCurrentShortcode","trim","console","log","getSelection","selectionText","undefined","fromDialog","onssdialogopen","parent","getNode","filter","eq","focus","redraw","onssdialogclose","onclose","tinymce","PluginManager","add"],"mappings":"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","file":"js/TinyMCE_call-to-action.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/src/legacy/entwine/TinyMCE_call-to-action.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e9e7175a25db2d41abfa","/* global tinymce, editorIdentifier, ss */\n/* eslint-disable\n  no-param-reassign,\n  func-names\n*/\n\nimport i18n from 'i18n';\nimport jQuery from 'jquery';\nimport ShortcodeSerialiser from 'lib/ShortcodeSerialiser';\nimport React from 'react';\n\nconst commandName = 'calltoaction';\n\nconst plugin = {\n\tinit(editor) {\n\t\teditor.addButton('calltoaction', {\n\t\t\ttext: i18n._t('CallToAction.ACTION_LABEL', '[CtA]'),\n\t\t\ttooltip: i18n._t('CallToAction.ACTION_TOOLTIP', 'Insert Call to Action'),\n\t\t\ticon: false,\n\t\t\tclass: 'mce_shortcode',\n\t\t\tcmd: commandName\n\t\t});\n\n\t\teditor.addCommand(commandName, () => {\n\t\t\tjQuery(`#${editor.id}`).entwine('ss').openCallToActionDialog(editor);\n\t\t});\n\n\t\teditor.addContextToolbar(\n\t\t\t(embed) => editor.dom.is(embed, 'div[data-cta-shortcode]'),\n\t\t\t'calltoaction'\n\t\t);\n\n\t\tthis.beforeSetContent(editor);\n\t\tthis.onSetContent(editor);\n\t\tthis.onPreProcess(editor);\n\t},\n\n\thandleRemoveCallToActionClick(editor) {\n\n\t},\n\tbeforeSetContent(editor) {\n\t\teditor.on('beforeSetContent', (e) => {\n\t\t\tconst placeholderClasses = jQuery(`#${editor.id}`).entwine('ss').getPlaceholderClasses();\n\t\t\tlet content = e.content;\n\t\t\tif (placeholderClasses) {\n\t\t\t\tplaceholderClasses.forEach((code) => {\n\t\t\t\t\tlet match = null;\n\t\t\t\t\tlet counter = 0;\n\t\t\t\t\twhile ((match = ShortcodeSerialiser.match(code, true, content)) && counter < 1000) {\n\t\t\t\t\t\tcounter +=1;\n\t\t\t\t\t\tif (match) {\n\t\t\t\t\t\t\tconst params = [];\n\t\t\t\t\t\t\tconst url = encodeURI(`CallToActionController/shortcodePlaceHolder/${code}`);\n\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t\ttype       : 'POST',\n\t\t\t\t\t\t\t\tdata       : JSON.stringify(match),\n\t\t\t\t\t\t\t\tcontentType: 'application/json; charset=utf-8',\n\t\t\t\t\t\t\t\tasync      : false,\n\t\t\t\t\t\t\t\tsuccess(html) {\n\t\t\t\t\t\t\t\t\thtml = $($(html));\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode', match.name);\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode-wrapped', match.wrapped);\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode-properties', JSON.stringify(match.properties));\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode-content', JSON.stringify(match.content));\n\t\t\t\t\t\t\t\t\tcontent = content.replaceAll(match.original, html.prop('outerHTML'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tcounter = 0;\n\t\t\t\t\twhile ((match = ShortcodeSerialiser.match(code, false, content)) && counter < 1000) {\n\t\t\t\t\t\tcounter +=1;\n\t\t\t\t\t\tif (match) {\n\t\t\t\t\t\t\tconst params = [];\n\t\t\t\t\t\t\tconst url = encodeURI(`CallToActionController/shortcodePlaceHolder/${code}`);\n\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t\ttype       : 'POST',\n\t\t\t\t\t\t\t\tdata       : JSON.stringify(match),\n\t\t\t\t\t\t\t\tcontentType: 'application/json; charset=utf-8',\n\t\t\t\t\t\t\t\tasync      : false,\n\t\t\t\t\t\t\t\tsuccess(html) {\n\t\t\t\t\t\t\t\t\thtml = $($(html));\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode', match.name);\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode-wrapped', match.wrapped);\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode-properties', JSON.stringify(match.properties));\n\t\t\t\t\t\t\t\t\thtml.attr('data-cta-shortcode-content', JSON.stringify(match.content));\n\t\t\t\t\t\t\t\t\tcontent = content.replaceAll(match.original, html.prop('outerHTML'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\te.content = content;\n\t\t});\n\t},\n\tonPreProcess(editor) {\n\t\teditor.on('PreProcess', (e) => {\n\t\t\t$('[data-cta-shortcode]', e.node).each((idx, elm) => {\n\t\t\t\tconst $elm = $(elm);\n\t\t\t\t$elm.removeAttr('contentEditable');\n\t\t\t\tconst code = $elm.data('cta-shortcode');\n\t\t\t\tconst wrapped = $elm.data('cta-shortcode-wrapped');\n\t\t\t\tconst properties = $elm.data('cta-shortcode-properties');\n\t\t\t\tconst content = $elm.data('cta-shortcode-content');\n\n\t\t\t\tconst shortcode = ShortcodeSerialiser.serialise({\n\t\t\t\t\tname: code,\n\t\t\t\t\tproperties: properties,\n\t\t\t\t\tcontent: content,\n\t\t\t\t\twrapped: wrapped\n\t\t\t\t}, true);\n\t\t\t\t$elm.replaceWith(shortcode);\n\t\t\t});\n\t\t});\n\t},\n\tonSetContent(editor) {\n\t\teditor.on('SetContent', (e) => {\n\t\t\tconst unprocessed = editor.$('[data-cta-shortcode]');\n\t\t\teditor.undoManager.transact(() => {\n\t\t\t\tunprocessed.each((idx, elm) => {\n\t\t\t\t\telm.contentEditable = false;\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n};\n\njQuery.entwine('ss', ($) => {\n\t// handle change on shortcode-type field\n\t$('select.shortcode-type').entwine({\n\t\tonchange() {\n\t\t\tthis.parents('form:first').reloadForm('type', this.val());\n\t\t}\n\t});\n\n\t// Dialog\n\t$('.htmleditorfield-dialog').entwine({\n\t\tBookmark: null,\n\t\tonadd() {\n\t\t\t// Create jQuery dialog\n\t\t\tif (!this.is('.ui-dialog-content')) {\n\t\t\t\tthis.ssdialog({ autoOpen: true });\n\t\t\t}\n\n\t\t\tthis._super();\n\t\t},\n\n\t\tgetForm() {\n\t\t\treturn this.find('form');\n\t\t},\n\t\topen(editor) {\n\t\t\tthis.ssdialog('open');\n\t\t},\n\t\tclose() {\n\t\t\tthis.ssdialog('close');\n\t\t},\n\t\ttoggle(bool) {\n\t\t\tif (this.is(':visible')) this.close();\n\t\t\telse this.open();\n\t\t}\n\t});\n\n\t// open shortcode dialog\n\t$('textarea.htmleditor').entwine({\n\t\tgetPlaceholderClasses() {\n\t\t\tconst classes = $(this).data('placeholderclasses');\n\t\t\tif (classes) {\n\t\t\t\treturn classes.split(',');\n\t\t\t}\n\t\t},\n\t\topenCallToActionDialog(editor) {\n\t\t\tlet self = this,\n\t\t\t    url = 'CallToActionController/CallToActionForm/forTemplate',\n\t\t\t    dialog = $('.htmleditorfield-calltoaction-dialog'),\n\t\t\t    bookmark = editor.selection.getBookmark(2, true);\n\n\t\t\tif (dialog.length) {\n\t\t\t\tdialog.getForm().setElement(this);\n\t\t\t\tdialog.setBookmark(bookmark);\n\t\t\t\tdialog.open(editor);\n\t\t\t} else {\n\t\t\t\tdialog = $('<div class=\"htmleditorfield-dialog htmleditorfield-calltoaction-dialog loading\">');\n\t\t\t\t$('body').append(dialog);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl,\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\tdialog.removeClass('loading');\n\t\t\t\t\t},\n\t\t\t\t\tsuccess(html) {\n\t\t\t\t\t\tdialog.html(html);\n\t\t\t\t\t\tdialog.getForm().setElement(self);\n\t\t\t\t\t\tdialog.setBookmark(bookmark);\n\t\t\t\t\t\tdialog.open(editor);\n\t\t\t\t\t\tdialog.trigger('ssdialogopen');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t});\n\n\t$('form.htmleditorfield-cta').entwine({\n\t\tSelection: null,\n\n\t\t// Implementation-dependent serialization of the current editor selection state\n\t\tBookmark: null,\n\n\t\t// DOMElement pointing to the currently active textarea\n\t\tElement: null,\n\n\t\tsetSelection(node) {\n\t\t\treturn this._super($(node));\n\t\t},\n\t\tonremove() {\n\t\t\tthis.setSelection(null);\n\t\t\tthis.setBookmark(null);\n\t\t\tthis.setElement(null);\n\n\t\t\tthis._super();\n\t\t},\n\t\t// load the shortcode form into the dialog\n\t\treloadForm(from, data) {\n\t\t\tconst postdata = {};\n\t\t\t\n\t\t\tif (from == 'type') {\n\t\t\t\tpostdata.CallToActionType = data;\n\t\t\t} else if (from == 'shortcode') {\n\t\t\t\tpostdata.Shortcode = data;\n\t\t\t}\n\n\t\t\tthis.addClass('loading');\n\n\t\t\tconst url = 'CallToActionController/CallToActionForm/forTemplate';\n\n\t\t\t$.post(url, postdata, (data) => {\n\t\t\t\tconst form = $('form.htmleditorfield-cta');\n\t\t\t\tform.find('fieldset').replaceWith($(data).find('fieldset')).show();\n\t\t\t\tform.removeClass('loading');\n\t\t\t});\n\t\t\treturn this;\n\t\t},\n\t\tonsubmit(e) {\n\t\t\tthis.insertShortcode();\n\t\t\tthis.getDialog().close();\n\t\t\treturn false;\n\t\t},\n\n\t\t// insert shortcode into editor\n\t\tinsertShortcode() {\n\t\t\tconst shortcode = this.getHTML();\n\t\t\tif (shortcode.length) {\n\t\t\t\tthis.modifySelection((ed) => {\n\t\t\t\t\tconst editor = ed.getInstance();\n\t\t\t\t\teditor.undoManager.transact(() => {\n\t\t\t\t\t\tconst calltoaction = tinyMCE.activeEditor.plugins.calltoaction;\n\t\t\t\t\t\ted.replaceContent(shortcode);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tmodifySelection(callback) {\n\t\t\tconst ed = this.getEditor();\n\n\t\t\ted.moveToBookmark(this.getBookmark());\n\t\t\tcallback.call(this, ed);\n\n\t\t\tthis.setSelection(ed.getSelectedNode());\n\t\t\tthis.setBookmark(ed.createBookmark());\n\n\t\t\ted.blur();\n\t\t},\n\n\t\tgetEditor() {\n\t\t\treturn this.getElement().getEditor();\n\t\t},\n\t\tgetDialog() {\n\t\t\treturn this.closest('.htmleditorfield-dialog');\n\t\t},\n\t\t// get the html to insert\n\t\tgetHTML() {\n\t\t\tconst data = this.getAttributes();\n\t\t\tlet html = data.shortcodeType;\n\t\t\tfor (const key in data.attributes) {\n\t\t\t\thtml += ` ${key}=\"${data.attributes[key]}\"`;\n\t\t\t}\n\n\t\t\tif (html.length) {\n\t\t\t\treturn `[${html}]`;\n\t\t\t}\n\t\t\t\treturn '';\n\t\t},\n\t\t// get shortcode attributes from shortcode form\n\t\tgetAttributes() {\n\t\t\tconst attributes = {};\n\t\t\tconst id = this.find(':input[name=id]').val();\n\t\t\tif (id) {\n\t\t\t\tattributes.id = id;\n\t\t\t}\n\t\t\tconst data = JSON.stringify(this.serializeArray());\n\n\t\t\tconst attributesComposite = this.find('.attributes-composite');\n\t\t\tif (attributesComposite.length) {\n\t\t\t\tattributesComposite.find(':input').each(function () {\n\t\t\t\t\tconst attributeField = $(this);\n\t\t\t\t\tconst attributeVal = attributeField.val();\n\t\t\t\t\tconst attributeName = attributeField.prop('name');\n\n\t\t\t\t\tif (attributeField.is('.checkbox') && !attributeField.is(':checked')) {\n\t\t\t\t\t\treturn true; // skip unchecked checkboxes\n\t\t\t\t\t}\n\n\t\t\t\t\tif (attributeVal !== '') {\n\t\t\t\t\t\tif (attributeName.indexOf('[') > -1) {\n\t\t\t\t\t\t\tconst key = attributeName.substring(0, attributeName.indexOf('['));\n\t\t\t\t\t\t\tif (typeof attributes[key] !== 'undefined') {\n\t\t\t\t\t\t\t\tattributes[key] += `,${attributeVal}`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tattributes[key] = attributeVal;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (attributeField.is('.checkbox')) {\n\t\t\t\t\t\t\t\tattributes[attributeField.prop('name')] = attributeField.is(':checked') ? 1 : 0;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tattributes[attributeField.prop('name')] = attributeVal;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tshortcodeType: this.find(':input[name=CallToActionType]').val().replaceAll(/\\\\/g, '_'),\n\t\t\t\tattributes\n\t\t\t};\n\t\t},\n\n\t\tresetFields() {\n\t\t\tthis._super();\n\t\t\t// trigger a change on the shortcode type field to reload all fields\n\t\t\tthis.find(':input[name=CallToActionType]').val('');\n\t\t\tthis.find('.attributes-composite').hide();\n\t\t\tthis.find('#id.field').hide();\n\t\t},\n\t\t/**\n\t\t * Updates the state of the dialog inputs to match the editor selection.\n\t\t * If selection does not contain a shortcode, resets the fields.\n\t\t */\n\t\tupdateFromEditor() {\n\t\t\tconst shortcode = this.getCurrentShortcode().trim();\n\t\t\tconsole.log(this.getCurrentShortcode());\n\t\t\tthis.reloadForm('shortcode', shortcode);\n\t\t},\n\t\tgetCurrentShortcode() {\n\t\t\tlet selection = $(this.getSelection()),\n\t\t\t    selectionText = selection.text();\n\t\t\t    \n\t\t\tif (selection.data('cta-shortcode') !== undefined) {\n\t\t\t\tconst $elm = selection;\n\t\t\t\tconst code = $elm.data('cta-shortcode');\n\t\t\t\tconst wrapped = $elm.data('cta-shortcode-wrapped');\n\t\t\t\tconst properties = $elm.data('cta-shortcode-properties');\n\t\t\t\tconst content = $elm.data('cta-shortcode-content');\n\n\t\t\t\tconst shortcode = ShortcodeSerialiser.serialise({\n\t\t\t\t\tname: code,\n\t\t\t\t\tproperties: properties,\n\t\t\t\t\tcontent: content,\n\t\t\t\t\twrapped: wrapped\n\t\t\t\t}, true);\n\n\t\t\t\treturn shortcode;\n\t\t\t}\n\t\t\treturn selectionText;\n\t\t},\n\t\tfromDialog: {\n\t\t\tonssdialogopen: function() {\n\t\t\t\tlet editor = this.getEditor().getInstance();\n\t\t\t\tthis.setBookmark(this.parent().getBookmark());\n\t\t\t\teditor.selection.moveToBookmark(this.parent().getBookmark());\n      \t\t\t\n      \t\t\tthis.setSelection(editor.selection.getNode());\n\n\t\t\t\t/*var ed = this.getEditor();\n\t\t\t\t//ed.onopen();\n\t\t\t\t\n\t\t\t\tthis.setSelection(ed.getSelectedNode());\n\t\t\t\tthis.setBookmark(ed.createBookmark());\n\n\t\t\t\ted.blur();*/\n\n\t\t\t\tthis.find(':input:not(:submit)[data-skip-autofocus!=\"true\"]').filter(':visible:enabled').eq(0).focus();\n\n\t\t\t\tthis.redraw();\n\t\t\t\tthis.updateFromEditor();\n\t\t\t},\n\n\t\t\tonssdialogclose: function(){\n\t\t\t\tvar ed = this.getEditor();\n\t\t\t\ted.onclose();\n\n\t\t\t\ted.moveToBookmark(this.getBookmark());\n\n\t\t\t\tthis.setSelection(null);\n\t\t\t\tthis.setBookmark(null);\n\n\t\t\t\tthis.resetFields();\n\t\t\t}\n\t\t},\n\t});\n});\n\n// Adds the plugin class to the list of available TinyMCE plugins\ntinymce.PluginManager.add(commandName, (editor) => plugin.init(editor));\n\nexport default plugin;\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/legacy/entwine/TinyMCE_call-to-action.js","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = 0","module.exports = React;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"React\"\n// module id = 1\n// module chunks = 0","module.exports = ShortcodeSerialiser;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ShortcodeSerialiser\"\n// module id = 2\n// module chunks = 0","module.exports = i18n;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"i18n\"\n// module id = 3\n// module chunks = 0"],"sourceRoot":""}